@using Microsoft.AspNetCore.Components.Authorization
@inherits LayoutComponentBase
@inject AuthenticationStateProvider AuthStateProvider
@inject AuthService Auth
@inject NavigationManager NavigationManager

<div class="d-flex min-vh-100">
    <div style="width:18rem;">
        <div class="p-4 border-bottom">
            <h1 class="h4 fw-bold">Operatio <img src="/img/efectivo-16.png" /></h1>
            <p class="small text-muted">Expenses Tracker</p>
        </div>
        <nav class="p-3">
            <AuthorizeView>
                <Authorized>
                    <a href="/" class="btn btn-primary w-100 mb-2">My Expenses</a>
                    <button class="btn btn-outline-danger w-100" @onclick="Logout">Logout</button>
                </Authorized>
                <NotAuthorized>
                    <a href="/login" class="btn btn-primary w-100 mb-2">Login</a>
                    <a href="/register" class="btn btn-outline-primary w-100">Register</a>
                </NotAuthorized>
            </AuthorizeView>
        </nav>
    </div>
    <div class="w-100 p-4">
        @Body
    </div>
</div>

@code {
    async Task Logout()
    {
        await Auth.LogoutAsync();
        if (AuthStateProvider is ExpensesTracker.Services.SimpleAuthStateProvider sap) sap.NotifyAuthChanged();
        NavigationManager.NavigateTo("/login");
    }
}